<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>pyChat</title>
<style type="text/css">
    body {
        font-family: helvetica, verdana, arial, sans-serif;
        font-weight: normal }
    #MessageList {
        overflow: auto; overflow-x: hidden;
        width: 648px; height: 600px;
        border: 1px solid black;
    }
    #PostMessage {
        padding-top: 16px;
    }
    #Login {
        padding-top: 16px;
    }
    textarea {
        width: 650px; height: 80px;
    }
    #Toolbar {
        position: absolute;
        left: 680px; top: 16px;
        border: 1px solid black;
    }
    table {
        width: 650px }
    td {
        border: 1px solid lightgrey; }
    td.header {
        width: 650px; height: 24px;
        background-color: whitesmoke }
    td.body {
        padding-top: 8px }
    img.role {
        width: 300px; }
    b {
        vertical-align: middle; }
</style>
<script type="text/javascript" src="jquery-1.4.4.min.js"></script>
<script type="text/javascript" src="jquery.cookie.js"></script>
<script type="text/javascript" src="http.js"></script>
<script type="text/javascript">
    var timestamp = 0;
    var sessionkey = $.cookie("702CCBC8-F4A3-11DF-8EFE-4405DFD72085");

    function resizeUI()
    {
        var postm = $("#PostMessage").outerHeight();
        var login = 0;
        var save = 32;
        if ($('#Login').is(':visible')) {
            login = $("#Login").outerHeight();
        }
        $("#MessageList").height($(window).height()-postm-login-save);
    }
</script>
</head>
<body>
    <div id="MessageList">
        <span></span>
    </div>
    <div id="PostMessage">
        <textarea id="EditMessage" wrap="hard"></textarea><br/>
    </div>
        <script type="text/javascript">
            $('#EditMessage').keydown(function(event) {
                if (event.keyCode == '13') {
                    event.preventDefault();
                    if (event.ctrlKey) {
                        var val = this.value;
                        if (typeof this.selectionStart == "number" && typeof this.selectionEnd == "number") {
                            var start = this.selectionStart;
                            this.value = val.slice(0, start) + "\n" + val.slice(this.selectionEnd);
                            this.selectionStart = this.selectionEnd = start + 1;
                        } else if (document.selection && document.selection.createRange) {
                            this.focus();
                            var range = document.selection.createRange();
                            range.text = "\r\n";
                            range.collapse(false);
                            range.select();
                        }
                    } else {
                        send_text();
                    }
                }
            });
        </script>
    <div id="Login">
        <table cellspacing='0'>
        <tr>
            <td colspan="2">
                <b>Please provide login information to get full access.</b>
            </td>
        </tr>
        <tr>
            <td style="width: 120px">Username:</td>
            <td><input id="Username"></input></td>
        </tr>
        <tr>
            <td>Password:</td>
            <td><input id="Password"></input></td>
        </tr>
        </table>
    </div>
        <script type="text/javascript">
            $('#Password').keydown(function(event) {
                if (event.keyCode == '13') {
                    event.preventDefault();
                    if (!event.ctrlKey) {
                        login();
                    }
                }
            });
        </script>

    <div id="Toolbar">
        <img class="role" src="wolf.png"></img>
    </div>
    <div id="dbg"></div>

    <script type="text/javascript">
        $(document).ready(function(){
            $("img").click(function(){
                $(this).hide();
            });

            resizeUI();
            var offset = $("#MessageList").offset();
            offset.left += 680;
            $("#Toolbar").offset(offset);

            init_poll();
        });

        $(window).resize(function(){
            resizeUI();
        });
    </script>
</body>
</html>